!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),s=document.querySelector("#game"),r=s&&s.getContext("2d"),o=new Image;function a(e,t){var n=e.x,i=e.y,s=n,r=i;return t.x<=n&&t.y<=i?s=224-Math.abs(n-t.x):t.x>=n&&t.y<=i?(r=224-Math.abs(i-t.y),s=224+Math.abs(n-t.x),r=224-Math.abs(i-t.y)):t.x<=n&&t.y>=i?(s=224-Math.abs(n-t.x),r=224+Math.abs(i-t.y)):t.x>=n&&t.y>=i&&(s=224+Math.abs(n-t.x),r=224+Math.abs(i-t.y)),{relX:s,relY:r}}o.src=i.default,t.drawShots=function(e){var t=e.state,n=e.constants;if(r){var i=n.shotImage,s=t.actions;t.status&&s.map((function(e){if(void 0!==e&&e.status){var n=a(t,e),s=n.relX,l=n.relY;r.drawImage(o,i.x,i.y,i.size,i.size,s,l,i.size,i.size)}}))}},t.drawEnemies=function(e){var t=e.state,n=e.constants;if(r&&t.status){var i=n.ghostSprite;t.enemies.map((function(e){if(e&&e.status){var n="Left"===e.direction||"Right"===e.direction?e.direction:"Left",s=a(t,e),l=s.relX,f=s.relY;r.drawImage(o,i[n][e.spriteCount].x,i[n][e.spriteCount].y,64,64,l,f,e.size,e.size)}}))}},t.drawTank=function(e){var t=e.state,n=e.constants;if(r&&o&&t.status){var i=t.direction,s=t.spriteCount,a=n.tileSize,l=n.tankSprite;r.drawImage(o,l[i][s].x,l[i][s].y,64,64,220,220,a,a)}},t.drawMessage=function(e){if(r){document.fonts.load('100px "ARCADECLASSIC"').then((function(){r.font="100px ARCADECLASSIC",r.fillStyle="black",r.textAlign="center",r.fillText(e,240,240)}))}},t.drawLevel=function(e){var t=e.state,n=e.constants;if(r){var i=n.tileSize,s=n.tileImage,a=n.floor;if(t.level&&t.status){r.fillStyle="#fffff8",r.fillRect(0,0,480,480);for(var l,f=Math.floor(t.x/i)-7,u=Math.floor(t.y/i)-7,c=t.x-Math.floor(t.x/i)*i,y=t.y-Math.floor(t.y/i)*i,h=u,v=0;v<16;v++){l=f;for(var d=0;d<16;d++){if(h>=0&&h<t.level.length&&l>=0&&l<t.level[0].length){var x=t.level[h][l];if(x!==a){var p=v*i-y,g=d*i-c;r.drawImage(o,s[x].x,s[x].y,64,64,g,p,i,i)}}l++}h++}}}}},function(e,t,n){"use strict";var i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),s=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,a=r.length;o<a;o++,s++)i[s]=r[o];return i};Object.defineProperty(t,"__esModule",{value:!0});var s=n(7),r=n(2);function o(e,t){var n=t.tileSize,s=t.floor,r=[],o=i(e).map((function(e,t){return e.map((function(e,i){return"x"===e?(r.push({x:i*n,y:t*n,status:!0,spriteCount:0,speed:1,size:32,direction:0===(o=2,Math.floor(Math.random()*Math.floor(o)))?"Left":"Right"}),s):e;var o}))}));return{enemies:r,level:o}}t.isEven=function(e){return function(t){return t%e==0}},t.isEnemyPositionEven=t.isEven(r.enemySize),t.fireCanon=function(e,t){var n=t.shotDiff,i=t.shotImage,s=e.x,r=e.y,o=e.direction,a=n[o];return{x:s+a[0],y:r+a[1],status:!0,size:i.size,speed:10,direction:o,hasHitEnemy:-1}},t.isPlayerInRange=function(e){return{x:e.x-250,y:e.y-250,w:e.size+500,h:e.size+500}},t.getBody=function(e){return{x:e.x,y:e.y,w:e.size,h:e.size}},t.extractEnemies=o;var a=s.rawLevels[0],l=s.rawLevels.slice(1);function f(e,t){return e===t.floor||e===t.closedChest||e===t.openChest}function u(e){return e.split("\n").map((function(e){return e.split("")}))}function c(e,t){return e.reduce((function(e,n,i){var s=[];return n.forEach((function(e,n){e===t.closedChest&&s.push({x:n,y:i})})),e.concat(s)}),[])}t.getLevel={first:function(e){return o(u(a),e)},chests:function(e,t){return c(0!==e?e:u(a),t)},next:function(e){var t=l.shift();return l.length>0&&void 0!==t?o(u(t),e):{level:!1}}},t.isPosObject=f,t.isAHit=function(e,t){return e.x<t.x+t.w&&e.x+e.w>t.x&&e.y<t.y+t.h&&e.y+e.h>t.y},t.isMovementPossible=function(e,t,n){var i=n.tileSize,s=e.direction,r=e.x,o=e.y,a=e.size,l=e.speed,u={Up:[{x:Math.floor(r/i),y:Math.floor((o-l-6)/i)},{x:Math.floor((r+a-6)/i),y:Math.floor((o-l-6)/i)}],Right:[{x:Math.floor((r+a+l-6)/i),y:Math.floor((o+6)/i)},{x:Math.floor((r+a+l-6)/i),y:Math.floor((o-6+a)/i)}],Down:[{x:Math.floor(r/i),y:Math.floor((o+a+l-6)/i)},{x:Math.floor((r+a-6)/i),y:Math.floor((o+a+l-6)/i)}],Left:[{x:Math.floor((r-l-6)/i),y:Math.floor((o+6)/i)},{x:Math.floor((r-l-6)/i),y:Math.floor((o-6+a)/i)}]}[s],c=u[0],y=u[1];return t&&f(t[c.y][c.x],n)&&f(t[y.y][y.x],n)?{isPossible:!0,hits:{first:{type:t[c.y][c.x],x:c.x,y:c.y},second:{type:t[y.y][y.x],x:y.x,y:y.y}}}:{isPossible:!1}},t.findPath=function(e,t,n,s){var r=e.map((function(e){return i(e)})),o=[{y:t.y,x:t.x,path:[],status:"Known"}];for(r[n.y][n.x]="G";o.length>0;){var a=o.shift();if(void 0!==a)for(var l=0,f=["Up","Down","Left","Right"];l<f.length;l++){var u=f[l],c=s.moveDiff,y=a.path.slice();y.push(u);var h=a.x,v=a.y,d=c[u];h+=d[0];var x={y:v+=d[1],x:h,path:y,status:"Unknown"};if(x.x<0||x.x>=r[0].length||x.y<0||x.y>=r.length)x.status="Invalid";else{if("G"===r[v][h])return x.status="Goal",x.path;r[v][h]!==s.floor?x.status="Blocked":(x.status="Valid",r[x.y][x.x]="Visited",o.push(x))}}}return!1},t.isActive=function(e){return!0===e.status},t.isEnemyHit=function(e,t){return e.some((function(e){return e.hasHitEnemy===t}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadSpeed=40,t.tileSize=32,t.enemySize=32,t.HEAD=0,t.closedChest="5",t.openChest="6",t.floor="0",t.tileImage={1:{x:0,y:0},2:{x:64,y:0},3:{x:128,y:0},4:{x:192,y:0},5:{x:256,y:0},6:{x:320,y:0}},t.tankSprite={Up:[{x:0,y:64},{x:64,y:64}],Down:[{x:128,y:64},{x:192,y:64}],Left:[{x:256,y:64},{x:320,y:64}],Right:[{x:384,y:64},{x:448,y:64}]},t.ghostSprite={Left:[{x:0,y:128},{x:64,y:128},{x:128,y:128}],Right:[{x:192,y:128},{x:320,y:128},{x:386,y:128}]},t.shotImage={x:64,y:0,size:10},t.moveDiff={Left:[-1,0],Right:[1,0],Up:[0,-1],Down:[0,1]},t.shotDiff={Left:[0,t.tileSize/2],Right:[t.tileSize,t.tileSize/2],Up:[t.tileSize/2,0],Down:[t.tileSize/2,t.tileSize]},t.constants={shotDiff:t.shotDiff,moveDiff:t.moveDiff,shotImage:t.shotImage,ghostSprite:t.ghostSprite,tankSprite:t.tankSprite,tileSize:t.tileSize,tileImage:t.tileImage,loadSpeed:t.loadSpeed,floor:t.floor,closedChest:t.closedChest,openChest:t.openChest,HEAD:t.HEAD}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Playing=0]="Playing",e[e.GameOver=1]="GameOver",e[e.PlayerWin=2]="PlayerWin"}(t.GameState||(t.GameState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),s=n(0),r=n(1),o=n(2),a=n(8),l=n(9),f=n(3),u={x:288,y:150,speed:5,spriteCount:0,chests:r.getLevel.chests(0,o.constants),status:!0,size:32,hasHitEnemy:-1,loading:0,direction:"Down",isMoving:{Up:!1,Down:!1,Left:!1,Right:!1},isShooting:!1,gameState:f.GameState.Playing,actions:[],level:r.getLevel.first(o.constants).level,enemies:r.getLevel.first(o.constants).enemies},c=function(e){var t=i.compose(l.handleGameStates,i.tee(s.drawShots),i.tee(s.drawEnemies),i.tee(s.drawTank),i.tee(s.drawLevel),a.listenToEvents,l.handleObjects,l.handleEnemies,l.handleMovement,l.handleCanon,l.handleChests)(e),n=t.state,r=t.constants;n.gameState===f.GameState.Playing&&requestAnimationFrame((function(){return c({state:n,constants:r})}))};requestAnimationFrame((function(){return c({state:u,constants:o.constants})})),document.addEventListener("keyup",a.handleKeyUp),document.addEventListener("keydown",a.handleKeyDown)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tee=function(e){return function(t){return e(t),t}},t.compose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.reduceRight((function(e,t){return t(e)}),t)}},t.deepFreeze=function e(t){for(var n=0,i=Object.keys(t);n<i.length;n++){var s=i[n];(Array.isArray(t[s])||"object"==typeof t[s])&&(Object.freeze(t),e(t[s]))}return Object.freeze(t)},t.deepCopy=function(e){return JSON.parse(JSON.stringify(e))}},function(e,t,n){"use strict";n.r(t),t.default=n.p+"bc7d4287955e53ade682742d134e20dc.png"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rawLevels=["00000001111111111111111100000222333000000000000000000000000000001\n000000010000000000000001000002000x3322222113333333300000000000000\n00011111000000000000000111112200000000000000000000100000000000000\n00010000000000003330000000000000000000000000000000100000000000000\n00010005000002223000000000000000x00000000011111111100000000000000\n0003333300000002000000x000000000000000000010000000000000000000000\n00000003000000020000000000000000000000000011111000000000000000000\n00000001000000010000000000000x00000000000000001000000000000000000\n0000000100001111222000000000022000000000000x001000000000000000000\n00000001000000000000000000000020000000000000001000000000000000000\n00000001110000000000000000000033111111111115001000000000000000000\n00000000010000000000000000000030000000000011111000000000000000000\n00000000010000002222200000000030000000000000000000000000000000000\n00000000010x00002000200000000030000000000000000000000000000000000\n00000000010000002000222211133330000000000000000000000000000000000\n00000000010000002000000000000000000000000000000000000000000000000\n00000000010000002000000000000000000000000000000000000000000000000\n00000000011111111000000000000000000000000000000000000000000000000","00000001111111122222230000222333333000000000000000000000000001\n00000001000000000200033100000200003322222113333333300000000000000\n00011111000000000200000111112200000000000000000000100000000000000\n00010000000000000233000000000000000000000005000000100000000000000\n000150000000000000000000000000000000x0000011111111100000000000000\n22230000000000000000000000000000000000000010000000000000000000000\n20000000000000000000000000500000000100000011111000000000000000000\n20000000000000000000000000000000000100000000001000000000000000000\n21110000000000000200000000000001111100000000001000000000000000000\n0001000000002222220000x000000000000111110000001000000000000000000\n00010000000020000000000000000000000100011100001111112000000000000\n00010000000020000000000000000222222200000000000000002000000000000\n000100x0000022222222200000000200000200000000000000002000000000000\n00010000000000002000200000000200000222200000000000002000000000000\n00010000000x00002000222211133300000000200111111111122000000000000\n00011111110050002000000000000000000000212200000000000000000000000\n00000000010000002000000000000000000000000000000000000000000000000\n00000000011111111000000000000000000000000000000000000000000000000","00000000000000222344400000000033330000000000000000000000000000000\n00002222222222222200000000000230003322222113333333300000000000000\n00032000050000000200003111112200000000000000000000100000000000000\n0003000000000000x233111000000000000000000500x00000100000000000000\n000100000000111111000000000000000000x0000011111111100000000000000\n22230000000000000000000000000000000000000010000000000000000000000\n20000000000000000000000000000000000100000011111000000000000000000\n2000000000000000010001000000000000010x000000xx1000000000000000000\n200000000000000011101110000x0001111100000000001000000000000000000\n20000000000000011111111100000000000111110000001000000000000000000\n20005000000000011111111100000000000100011100001111112000000000000\n20000000000000011111111100000000000000000000000000002000000000000\n200000x0000000001111111000000000000000000500000000002000000000000\n2x000000000000000111110000100000000000000000000000002000000000000\n22222222100x00000011100000111112111002222222222222222000000000000\n00000000100000000000000000000000001222000000000000000000000000000\n00000000100000000000000000000x00001000000000000000000000000000000\n0000000111111111111111111111111111000000000000000000000000000000"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={direction:"Down",isMoving:{Up:!1,Down:!1,Left:!1,Right:!1},isShooting:!1};t.listenToEvents=function(e){var t=e.state,n=e.constants,s=i.direction;return i.isShooting&&(t.isShooting=!0,i.isShooting=!1),t.direction!==s&&(t.direction=i.direction),t.isMoving[s]!==i.isMoving[s]&&(t.isMoving[s]=i.isMoving[s]),{state:t,constants:n}},t.handleKeyDown=function(e){if(e.key.startsWith("Arrow")&&!Object.values(i.isMoving).some((function(e){return e}))){var t=e.key.slice(5);i.direction=t,i.isMoving[t]=!0}"Enter"===e.key&&(i.isShooting=!0)},t.handleKeyUp=function(e){if(e.key.startsWith("Arrow")){var t=e.key.slice(5);i.isMoving[t]=!1}"Enter"===e.key&&(i.isShooting=!1)}},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),s=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,a=r.length;o<a;o++,s++)i[s]=r[o];return i};Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(0),a=n(1);t.handleEnemies=function(e){var t=e.state,n=e.constants,s=n.moveDiff,r=n.HEAD,o=t.enemies.map((function(e,o){var l=e.x,f=e.y,u=e.direction,c=e.status,y=e.spriteCount,h=a.getBody(t),v=a.isPlayerInRange(e);if(!a.isAHit(v,h))return e;if(a.isEnemyPositionEven(e.x)){var d={x:Math.floor(e.x/e.size),y:Math.floor(e.y/e.size)},x={x:Math.floor(t.x/t.size),y:Math.floor(t.y/t.size)},p=t.level&&a.findPath(t.level,d,x,n);!1!==p&&(u=p[r])}var g=s[u];return l+=g[0],f+=g[1],y=y+1===3?0:y+1,c=!a.isEnemyHit(t.actions,o),i(i({},e),{direction:u,x:l,y:f,status:c,spriteCount:y})}));return t.enemies=o.filter(a.isActive),{state:t,constants:n}},t.handleObjects=function(e){var t=e.state,n=e.constants,r=t.actions.filter(a.isActive).map((function(e){var s=e.x,r=e.y,o=e.status,l=e.hasHitEnemy;if(a.isMovementPossible(e,t.level,n).isPossible){var f=n.moveDiff[e.direction],u=f[0],c=f[1];s+=u*e.speed,r+=c*e.speed}else o=!1;return-1!==(l=t.enemies.findIndex((function(t){return a.isAHit({x:t.x,y:t.y,w:t.size,h:t.size},{x:e.x,y:e.y,w:e.size,h:e.size})})))&&(o=!1),i(i({},e),{status:o,x:s,y:r,hasHitEnemy:l})}));return t.actions=s(r),{state:t,constants:n}},t.handleMovement=function(e){var t=e.state,n=e.constants,s=n.moveDiff,o=n.openChest,l=n.closedChest,f=Object.entries(t.isMoving).find((function(e){e[0];return e[1]})),u=t.direction,c=t.gameState,y=t.status,h=t.size,v=t.speed,d=t.x,x=t.y,p=t.spriteCount,g=t.hasHitEnemy;if(f){var m=s[f[0]],S=m[0],M=m[1],b={direction:u,status:y,size:h,speed:v,x:d,y:x,hasHitEnemy:g},z=a.isMovementPossible(b,t.level,n);if(z.isPossible&&t.level&&z.hits){var w=z.hits,P=w.first,E=w.second;P.type!==l&&E.type!==l||(P.type===l?t.level[P.y][P.x]=o:t.level[E.y][E.x]=o,t.chests=t.chests.filter((function(e){return e.x!==P.x&&e.y!==P.x||e.x!==E.x&&e.y!==E.y}))),p=p+1===2?0:p+1,x+=M,d+=S}}return-1!==(g=t.enemies.findIndex((function(e){return a.isAHit({x:e.x,y:e.y,w:e.size,h:e.size},{x:d,y:x,w:h,h:h})})))&&(c=r.GameState.GameOver),{state:t=i(i({},t),{hasHitEnemy:g,gameState:c,x:d,y:x,spriteCount:p}),constants:n}},t.handleCanon=function(e){var t=e.state,n=e.constants,s=t.loading,r=t.isShooting,o=n.loadSpeed;if(r&&(r=!1,0===s)){s=o;var l=a.fireCanon(t,n);t.actions.push(l)}return s>0&&s--,{state:t=i(i({},t),{loading:s,isShooting:r}),constants:n}},t.handleGameStates=function(e){var t=e.state,n=e.constants;return t.gameState!==r.GameState.Playing&&(t.gameState===r.GameState.PlayerWin?(console.log("This is the End"),o.drawMessage("This is the End.")):t.gameState===r.GameState.GameOver&&(console.log("Game Over"),o.drawMessage("Game Over"))),{state:t,constants:n}},t.handleChests=function(e){var t=e.state,n=e.constants;if(0===t.chests.length){var i=a.getLevel.next(n);i.level?(t.level=i.level,t.enemies=i.enemies,t.chests=a.getLevel.chests(t.level,n)):t.gameState=r.GameState.PlayerWin}return{state:t,constants:n}}}]);